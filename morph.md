Quickstart: Fast Apply

Copy page

Replace full file rewrites or search and replace with Fast Apply in 5 minutes

Morph Fast Apply Quickstart
​
Overview
What is Morph for? Morph Fast Apply looks like a new edit_file tool you give your agent access to. That’s it. Claude will output lazily into this tool when it wants to make an edit. In the tools execution, the Morph API will merge the lazy edit output by Claude/Gemini/etc. into the file.
If you like using Cursor - you already like the Fast Apply UX. Fast Apply is a concept used in Cursor.
​
How to use Morph Fast Apply
Try the API Playground
Test the Apply Model with live examples in our interactive playground
1
1. Add an edit_file tool to your agent

Add the edit_file tool to your agent. Use one of the formats below.
General Prompt
JSON Tool (Claude)
Output Parsing (No Tool)
Tool Description

Copy

Ask AI
Use this tool to make an edit to an existing file.

This will be read by a less intelligent model, which will quickly apply the edit. You should make it clear what the edit is, while also minimizing the unchanged code you write.
When writing the edit, you should specify each edit in sequence, with the special comment // ... existing code ... to represent unchanged code in between edited lines.

For example:

// ... existing code ...
FIRST_EDIT
// ... existing code ...
SECOND_EDIT
// ... existing code ...
THIRD_EDIT
// ... existing code ...

You should still bias towards repeating as few lines of the original file as possible to convey the change.
But, each edit should contain minimally sufficient context of unchanged lines around the code you're editing to resolve ambiguity.
DO NOT omit spans of pre-existing code (or comments) without using the // ... existing code ... comment to indicate its absence. If you omit the existing code comment, the model may inadvertently delete these lines.
If you plan on deleting a section, you must provide context before and after to delete it. If the initial code is ```code \n Block 1 \n Block 2 \n Block 3 \n code```, and you want to remove Block 2, you would output ```// ... existing code ... \n Block 1 \n  Block 3 \n // ... existing code ...```.
Make sure it is clear what the edit should be, and where it should be applied.
Make edits to a file in a single edit_file call instead of multiple edit_file calls to the same file. The apply model can handle many distinct edits at once.
Parameters:
target_filepath (string, required): The path of the target file to modify
instructions (string, required): A single sentence written in the first person describing what the agent is changing. Used to help disambiguate uncertainty in the edit.
code_edit (string, required): Specify ONLY the precise lines of code that you wish to edit. Use // ... existing code ... for unchanged sections.
IMPORTANT: The instructions param should be generated by the model not hardcoded. Example: “I am adding error handling to the user auth and removing the old auth functions”
Why do I need the instructions to be generated by the model?
The instructions parameter provides crucial context for ambiguous edits, helping the apply model make correct decisions and achieve near 100% accuracy even in edge cases.
2
Merge with Morph Fast Apply

Your tool’s execution should use Morph’s API to merge the code. Then you should write the code to a file.
What to add to your System Prompt


TypeScript

Python

cURL

Copy

Ask AI
import OpenAI from "openai";

const openai = new OpenAI({
  apiKey: process.env.MORPH_API_KEY,
  baseURL: "https://api.morphllm.com/v1",
});

const response = await openai.chat.completions.create({
  model="morph-v3-fast",
  messages: [
    {
      role: "user",
      content: `<instruction>${instructions}</instruction>\n<code>${initialCode}</code>\n<update>${codeEdit}</update>`,
    },
  ],
});

const mergedCode = response.choices[0].message.content;
3
Handle the Response

Extract the merged code from the API response. Use your filesystem to write the code to a file.
Response Format:

Copy

Ask AI
final_code = response.choices[0].message.content
Extract the Final Code:

extract_code.ts

extract_code.py

cURL

Copy

Ask AI
const finalCode = response.choices[0].message.content;
// Write to file or return to your application
await fs.writeFile(targetFile, finalCode);
4
Verifying Edits (Optional but Recommended)

We recommend passing the code changes back to the agent in UDiff format. This allows the agent to verify that the changes match its intent and make any necessary corrections. To save on tokens, another option is to check for linting errors and only pass the calculated udiff back when there are linting errors.

TypeScript

Python

Bash

Copy

Ask AI
import { createTwoFilesPatch } from 'diff';

// Generate UDiff between original and modified code
const udiff = createTwoFilesPatch(
  targetFile, 
  targetFile,
  initialCode,
  mergedCode,
  '', 
  ''
);

// Send back to agent for verification
console.log("Changes applied:", udiff);
This verification step helps catch any unexpected changes and ensures the applied edits match the agent’s intentions.
​
Next Steps
Ready to start building with Morph? Here’s what to do next:
Explore the Apply API
Learn about the Apply API endpoints for production use
Build Agentic Tools
Create edit_file tools for AI agents and development environments

# Apply API

> Apply changes from big models into your files. Find your [API key](https://morphllm.com/dashboard).

## OpenAPI

````yaml POST /v1/chat/completions
paths:
  path: /v1/chat/completions
  method: post
  servers:
    - url: https://morphllm.com
  request:
    security:
      - title: bearerAuth
        parameters:
          query: {}
          header:
            Authorization:
              type: http
              scheme: bearer
          cookie: {}
    parameters:
      path: {}
      query: {}
      header: {}
      cookie: {}
    body:
      application/json:
        schemaArray:
          - type: object
            properties:
              model:
                allOf:
                  - type: string
                    description: ID of the model to use
                    enum:
                      - morph-v3-fast
                      - morph-v3-large
                      - auto
                    example: morph-v3-large
              messages:
                allOf:
                  - type: array
                    description: >-
                      Array containing a single user message with structured
                      content using instruction-guided format
                    items:
                      type: object
                      required:
                        - role
                        - content
                      properties:
                        role:
                          type: string
                          description: The role of the message author
                          enum:
                            - user
                          example: user
                        content:
                          type: string
                          description: >-
                            Message content with required format:
                            <instruction>First-person
                            description</instruction><code>Complete original
                            file content</code><update>Code snippet with // ...
                            existing code ... markers</update>
                          example: >-
                            <instruction>I will add error handling to the divide
                            function</instruction>

                            <code>function divide(a, b) {
                              return a / b;
                            }</code>

                            <update>function divide(a, b) {
                              if (b === 0) throw new Error('Division by zero');
                              return a / b;
                            }</update>
              stream:
                allOf:
                  - type: boolean
                    description: Enable streaming response
                    default: false
                    example: false
            required: true
            refIdentifier: '#/components/schemas/ChatCompletionRequest'
            requiredProperties:
              - model
              - messages
        examples:
          example:
            value:
              model: morph-v3-large
              messages:
                - role: user
                  content: >-
                    <instruction>I will add error handling to the divide
                    function</instruction>

                    <code>function divide(a, b) {
                      return a / b;
                    }</code>

                    <update>function divide(a, b) {
                      if (b === 0) throw new Error('Division by zero');
                      return a / b;
                    }</update>
              stream: false
        description: Code update request
  response:
    '200':
      application/json:
        schemaArray:
          - type: object
            properties:
              id:
                allOf:
                  - $ref: '#/components/schemas/ResponseId'
              object:
                allOf:
                  - $ref: '#/components/schemas/ResponseObject'
              created:
                allOf:
                  - $ref: '#/components/schemas/ResponseCreated'
              choices:
                allOf:
                  - $ref: '#/components/schemas/ResponseChoices'
              usage:
                allOf:
                  - $ref: '#/components/schemas/ResponseUsage'
            refIdentifier: '#/components/schemas/ChatCompletionResponse'
            requiredProperties:
              - id
              - object
              - created
              - choices
              - usage
        examples:
          example:
            value:
              id: chatcmpl-123
              object: chat.completion
              created: 1677652288
              choices:
                - index: 0
                  message:
                    role: assistant
                    content: |

                      def calculate_total(items):
                          total = 0
                          for item in items:
                              total += item.price
                          return total * 1.1  # Add 10% tax
                  finish_reason: stop
              usage:
                prompt_tokens: 25
                completion_tokens: 32
                total_tokens: 57
        description: Chat completion response
    '400':
      application/json:
        schemaArray:
          - type: object
            properties:
              error:
                allOf:
                  - &ref_0
                    type: object
                    properties:
                      message:
                        type: string
                        description: Error message
                        example: Invalid API key
                      type:
                        type: string
                        description: Error type
                        example: invalid_request_error
                      code:
                        type: string
                        description: Error code
                        example: invalid_api_key
            refIdentifier: '#/components/schemas/Error'
            requiredProperties: &ref_1
              - error
        examples:
          example:
            value:
              error:
                message: Invalid API key
                type: invalid_request_error
                code: invalid_api_key
        description: Bad request error
    '401':
      application/json:
        schemaArray:
          - type: object
            properties:
              error:
                allOf:
                  - *ref_0
            refIdentifier: '#/components/schemas/Error'
            requiredProperties: *ref_1
        examples:
          example:
            value:
              error:
                message: Invalid API key
                type: invalid_request_error
                code: invalid_api_key
        description: Authentication error
  deprecated: false
  type: path
components:
  schemas:
    ResponseId:
      type: string
      description: Unique identifier for the completion
      example: chatcmpl-123
    ResponseObject:
      type: string
      description: Object type
      example: chat.completion
    ResponseCreated:
      type: integer
      description: Unix timestamp of when the completion was created
      example: 1677652288
    ResponseChoices:
      type: array
      description: List of completion choices
      items:
        $ref: '#/components/schemas/Choice'
    ResponseUsage:
      type: object
      description: Usage statistics for the completion request
      properties:
        prompt_tokens:
          type: integer
          description: Number of tokens in the prompt
          example: 25
        completion_tokens:
          type: integer
          description: Number of tokens in the completion
          example: 32
        total_tokens:
          type: integer
          description: Total number of tokens used
          example: 57
    Choice:
      type: object
      required:
        - index
        - message
        - finish_reason
      properties:
        index:
          type: integer
          description: Index of the choice in the list
          example: 0
        message:
          type: object
          description: The message generated by the model
          properties:
            role:
              type: string
              description: The role of the message author
              example: assistant
            content:
              type: string
              description: The content of the message
              example: |

                def calculate_total(items):
                    total = 0
                    for item in items:
                        total += item.price
                    return total * 1.1  # Add 10% tax
        finish_reason:
          type: string
          description: The reason the model stopped generating tokens
          example: stop

````

# Embedding API

> Generate embeddings for code

## OpenAPI

````yaml POST /v1/embeddings
paths:
  path: /v1/embeddings
  method: post
  servers:
    - url: https://morphllm.com
  request:
    security:
      - title: bearerAuth
        parameters:
          query: {}
          header:
            Authorization:
              type: http
              scheme: bearer
          cookie: {}
    parameters:
      path: {}
      query: {}
      header: {}
      cookie: {}
    body:
      application/json:
        schemaArray:
          - type: object
            properties:
              model:
                allOf:
                  - type: string
                    description: ID of the model to use for embedding generation
                    example: morph-embedding-v3
              input:
                allOf:
                  - oneOf:
                      - type: string
                        description: The text to generate embeddings for
                        example: function calculateSum(a, b) { return a + b; }
                      - type: array
                        description: An array of texts to generate embeddings for
                        items:
                          type: string
                        example:
                          - function calculateSum(a, b) { return a + b; }
                          - >-
                            class User { constructor(name) { this.name = name; }
                            }
              encoding_format:
                allOf:
                  - type: string
                    description: The format in which the embeddings are returned
                    enum:
                      - float
                      - base64
                    default: float
            required: true
            refIdentifier: '#/components/schemas/EmbeddingRequest'
            requiredProperties:
              - model
              - input
        examples:
          example:
            value:
              model: morph-embedding-v3
              input: function calculateSum(a, b) { return a + b; }
              encoding_format: float
        description: Embedding generation request
  response:
    '200':
      application/json:
        schemaArray:
          - type: object
            properties:
              object:
                allOf:
                  - type: string
                    description: Object type
                    example: list
              data:
                allOf:
                  - type: array
                    description: List of embedding objects
                    items:
                      type: object
                      properties:
                        object:
                          type: string
                          description: Object type
                          example: embedding
                        embedding:
                          type: array
                          description: The embedding vector
                          items:
                            type: number
                          example:
                            - 0.0023064255
                            - -0.009327292
                            - 0.01183665
                        index:
                          type: integer
                          description: Index of the embedding in the list
                          example: 0
              model:
                allOf:
                  - type: string
                    description: ID of the model used
                    example: morph-embedding-v3
              usage:
                allOf:
                  - type: object
                    description: Usage statistics
                    properties:
                      prompt_tokens:
                        type: integer
                        description: Number of tokens in the prompt
                        example: 8
                      total_tokens:
                        type: integer
                        description: Total number of tokens used
                        example: 8
            refIdentifier: '#/components/schemas/EmbeddingResponse'
            requiredProperties:
              - object
              - data
              - model
              - usage
        examples:
          example:
            value:
              object: list
              data:
                - object: embedding
                  embedding:
                    - 0.0023064255
                    - -0.009327292
                    - 0.01183665
                  index: 0
              model: morph-embedding-v3
              usage:
                prompt_tokens: 8
                total_tokens: 8
        description: Embedding response
    '400':
      application/json:
        schemaArray:
          - type: object
            properties:
              error:
                allOf:
                  - &ref_0
                    type: object
                    properties:
                      message:
                        type: string
                        description: Error message
                        example: Invalid API key
                      type:
                        type: string
                        description: Error type
                        example: invalid_request_error
                      code:
                        type: string
                        description: Error code
                        example: invalid_api_key
            refIdentifier: '#/components/schemas/Error'
            requiredProperties: &ref_1
              - error
        examples:
          example:
            value:
              error:
                message: Invalid API key
                type: invalid_request_error
                code: invalid_api_key
        description: Bad request error
    '401':
      application/json:
        schemaArray:
          - type: object
            properties:
              error:
                allOf:
                  - *ref_0
            refIdentifier: '#/components/schemas/Error'
            requiredProperties: *ref_1
        examples:
          example:
            value:
              error:
                message: Invalid API key
                type: invalid_request_error
                code: invalid_api_key
        description: Authentication error
  deprecated: false
  type: path
components:
  schemas: {}

````

# Rerank API

> Rerank search results by relevance

## OpenAPI

````yaml POST /v1/rerank
paths:
  path: /v1/rerank
  method: post
  servers:
    - url: https://morphllm.com
  request:
    security:
      - title: bearerAuth
        parameters:
          query: {}
          header:
            Authorization:
              type: http
              scheme: bearer
          cookie: {}
    parameters:
      path: {}
      query: {}
      header: {}
      cookie: {}
    body:
      application/json:
        schemaArray:
          - type: object
            properties:
              model:
                allOf:
                  - &ref_0
                    type: string
                    description: ID of the model to use for reranking
                    example: morph-rerank-v3
              query:
                allOf:
                  - &ref_1
                    type: string
                    description: The search query to compare documents against
                    example: How to implement JWT authentication in Express
              documents:
                allOf:
                  - &ref_2
                    type: array
                    description: >-
                      An array of document strings to be reranked. Required if
                      embedding_ids is not provided.
                    items:
                      type: string
                    example:
                      - >-
                        This Express.js middleware provides authentication using
                        JWT tokens and protects routes.
                      - >-
                        Express.js is a popular web framework for Node.js
                        applications.
              embedding_ids:
                allOf:
                  - &ref_3
                    type: array
                    description: >-
                      An array of embedding IDs to rerank. Required if documents
                      is not provided. Remote content storage must be enabled.
                    items:
                      type: string
                    example:
                      - emb_123456789
                      - emb_987654321
              top_n:
                allOf:
                  - &ref_4
                    type: integer
                    description: Number of top results to return
                    default: null
                    example: 5
            required: true
            refIdentifier: '#/components/schemas/RerankRequest'
            requiredProperties:
              - model
              - query
              - documents
          - type: object
            properties:
              model:
                allOf:
                  - *ref_0
              query:
                allOf:
                  - *ref_1
              documents:
                allOf:
                  - *ref_2
              embedding_ids:
                allOf:
                  - *ref_3
              top_n:
                allOf:
                  - *ref_4
            required: true
            refIdentifier: '#/components/schemas/RerankRequest'
            requiredProperties:
              - model
              - query
              - embedding_ids
        examples:
          example:
            value:
              model: morph-rerank-v3
              query: How to implement JWT authentication in Express
              documents:
                - >-
                  This Express.js middleware provides authentication using JWT
                  tokens and protects routes.
                - >-
                  Express.js is a popular web framework for Node.js
                  applications.
              embedding_ids:
                - emb_123456789
                - emb_987654321
              top_n: 5
        description: Reranking request
  response:
    '200':
      application/json:
        schemaArray:
          - type: object
            properties:
              model:
                allOf:
                  - type: string
                    description: ID of the model used
                    example: morph-rerank-v3
              results:
                allOf:
                  - type: array
                    description: List of reranked results
                    items:
                      type: object
                      properties:
                        index:
                          type: integer
                          description: Original index of the document in the input array
                          example: 0
                        document:
                          type: string
                          description: >-
                            The document text (included if return_documents is
                            true)
                          example: >-
                            This Express.js middleware provides authentication
                            using JWT tokens and protects routes.
                        relevance_score:
                          type: number
                          description: >-
                            Score indicating relevance to the query (higher is
                            more relevant)
                          example: 0.92
            refIdentifier: '#/components/schemas/RerankResponse'
            requiredProperties:
              - model
              - results
        examples:
          example:
            value:
              model: morph-rerank-v3
              results:
                - index: 0
                  document: >-
                    This Express.js middleware provides authentication using JWT
                    tokens and protects routes.
                  relevance_score: 0.92
        description: Reranking response
    '400':
      application/json:
        schemaArray:
          - type: object
            properties:
              error:
                allOf:
                  - &ref_5
                    type: object
                    properties:
                      message:
                        type: string
                        description: Error message
                        example: Invalid API key
                      type:
                        type: string
                        description: Error type
                        example: invalid_request_error
                      code:
                        type: string
                        description: Error code
                        example: invalid_api_key
            refIdentifier: '#/components/schemas/Error'
            requiredProperties: &ref_6
              - error
        examples:
          example:
            value:
              error:
                message: Invalid API key
                type: invalid_request_error
                code: invalid_api_key
        description: Bad request error
    '401':
      application/json:
        schemaArray:
          - type: object
            properties:
              error:
                allOf:
                  - *ref_5
            refIdentifier: '#/components/schemas/Error'
            requiredProperties: *ref_6
        examples:
          example:
            value:
              error:
                message: Invalid API key
                type: invalid_request_error
                code: invalid_api_key
        description: Authentication error
  deprecated: false
  type: path
components:
  schemas: {}

````

# MCP Integration

> Connect to Morph's blazing-fast file editing via Model Context Protocol

<img className="block dark:hidden" src="https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=bac5a5896ce29bf57d31cfe49ea08ba5" alt="Morph MCP Integration" data-og-width="1024" width="1024" data-og-height="1024" height="1024" data-path="images/mcp.png" data-optimize="true" data-opv="3" srcset="https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=280&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=7d91ba67eb5c712ae73edab0f0b95097 280w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=560&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=f2e5992a92df22a3e253fc69e12a6d9f 560w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=840&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=343fd964dd34d12ea91b89e34901aeed 840w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=1100&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=32fdb1f594d3d97447f3b75a400757cd 1100w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=1650&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=cc3df0cf4c753f9b69196aceda506b80 1650w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=2500&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=1eea8428ddc5caf23abd2297dfe11072 2500w" />

<img className="hidden dark:block" src="https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=bac5a5896ce29bf57d31cfe49ea08ba5" alt="Morph MCP Integration" data-og-width="1024" width="1024" data-og-height="1024" height="1024" data-path="images/mcp.png" data-optimize="true" data-opv="3" srcset="https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=280&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=7d91ba67eb5c712ae73edab0f0b95097 280w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=560&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=f2e5992a92df22a3e253fc69e12a6d9f 560w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=840&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=343fd964dd34d12ea91b89e34901aeed 840w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=1100&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=32fdb1f594d3d97447f3b75a400757cd 1100w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=1650&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=cc3df0cf4c753f9b69196aceda506b80 1650w, https://mintcdn.com/morph-555d6c14/1uZwQK90g2KbfDMm/images/mcp.png?w=2500&fit=max&auto=format&n=1uZwQK90g2KbfDMm&q=85&s=1eea8428ddc5caf23abd2297dfe11072 2500w" />

## Overview

Connect AI tools to Morph's 10,500+ tokens/sec file editing via Model Context Protocol. Works with Claude, Cursor, VS Code, and other MCP clients with automatic workspace detection.

## Tool Modes

<CardGroup cols={2}>
  <Card title="Edit-Only Mode" icon="code">
    **ALL\_TOOLS: "false"**

    Perfect for fast, focused editing:

    * `edit_file` - Lightning-fast code edits using Morph Apply
  </Card>

  <Card title="Full Filesystem Mode" icon="settings">
    **ALL\_TOOLS: "true"**

    Complete filesystem access:

    * `edit_file` - Fast code edits via Morph Apply
    * `read_file`, `write_file`
    * `list_directory`, `create_directory`
    * `search_files`, `move_file`
    * `get_file_info` + more filesystem tools
  </Card>
</CardGroup>

## Installation

<Steps>
  <Step title="1. Configure Your MCP Client">
    <Tabs>
      <Tab title="Claude Code">
        **One-liner Installation (Recommended)**:

        ```bash  theme={null}
        claude mcp add filesystem-with-morph -e MORPH_API_KEY=your-api-key-here -e ALL_TOOLS=false -- npx @morph-llm/morph-fast-apply
        ```

        <Note>
          **Configure Claude to prefer Morph**: Add this to your Claude instructions to ensure Claude uses Morph for all code edits:

          ```bash  theme={null}
          echo "IMPORTANT: ALWAYS use mcp_filesystem-with-morph_edit_file tool to make any code edits. Do not use the default edit tool." > .claude/CLAUDE.md
          ```
        </Note>

        **Manual Config File Method**:

        Create or edit `.claude.json` in your workspace:

        ```json  theme={null}
        {
          "mcpServers": {
            "filesystem-with-morph": {
              "command": "npx",
              "args": [
                "@morph-llm/morph-fast-apply"
              ],
              "env": {
                "MORPH_API_KEY": "your-api-key-here",
                "ALL_TOOLS": "false"
              }
            }
          }
        }
        ```
      </Tab>

      <Tab title="Codex">
        **CLI Installation (Recommended)**:

        ```bash  theme={null}
        # Add Morph MCP server to Codex
        codex mcp add filesystem-with-morph -e MORPH_API_KEY=your-api-key-here -e ALL_TOOLS=true -- npx @morph-llm/morph-fast-apply
        ```

        **Manual Config File**:

        Add to `~/.codex/config.toml`:

        ```toml  theme={null}
        [mcp_servers.filesystem-with-morph]
        command = "npx"
        args = ["@morph-llm/morph-fast-apply"]
        env = { "MORPH_API_KEY" = "your-api-key-here", "ALL_TOOLS" = "true" }
        # Optional: adjust timeouts
        startup_timeout_sec = 10
        tool_timeout_sec = 60
        ```

        <Note>
          **CLI Management**: Use `codex mcp list` to see configured servers and `codex mcp remove filesystem-with-morph` to remove.
        </Note>
      </Tab>

      <Tab title="Claude Desktop">
        Add to your Claude Desktop config file:

        **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`\
        **Windows**: `%APPDATA%/Claude/claude_desktop_config.json`

        ```json  theme={null}
        {
          "mcpServers": {
            "filesystem-with-morph": {
              "command": "npx",
              "args": [
                "@morph-llm/morph-fast-apply"
              ],
              "env": {
                "MORPH_API_KEY": "your-api-key-here",
                "ALL_TOOLS": "true"
              }
            }
          }
        }
        ```

        <Note>
          **Restart Required**: Completely quit and restart Claude Desktop to load the new configuration.
        </Note>
      </Tab>

      <Tab title="Cursor">
        Add to your Cursor MCP config file:

        **Location**: `~/.cursor/mcp.json`

        ```json  theme={null}
        {
          "mcpServers": {
            "filesystem-with-morph": {
              "command": "npx",
              "args": [
                "@morph-llm/morph-fast-apply"
              ],
              "env": {
                "MORPH_API_KEY": "your-api-key-here",
                "ALL_TOOLS": "true"
              }
            }
          }
        }
        ```

        <Note>
          **Global Config**: This configuration works across all your projects automatically. The MCP server detects workspace boundaries via `.git`, `package.json`, and other project indicators.
        </Note>
      </Tab>

      <Tab title="VS Code">
        Add to your workspace's `.vscode/mcp.json` file:

        ```json  theme={null}
        {
          "mcpServers": {
            "filesystem-with-morph": {
              "command": "npx",
              "args": [
                "@morph-llm/morph-fast-apply"
              ],
              "env": {
                "MORPH_API_KEY": "your-api-key-here",
                "ALL_TOOLS": "true"
              }
            }
          }
        }
        ```
      </Tab>

      <Tab title="Manual">
        Run the MCP server directly:

        ```bash  theme={null}
        export MORPH_API_KEY="your-api-key-here"
        export ALL_TOOLS="true"  # or "false" for edit-only mode
        npx @morph-llm/morph-fast-apply
        ```
      </Tab>
    </Tabs>
  </Step>

  <Step title="2. Get API Key">
    Get your API key from the [dashboard](https://morphllm.com/dashboard/api-keys) and replace `your-api-key-here` in your configuration.
  </Step>

  <Step title="3. Test Installation">
    **Claude**: Type `/mcp` and `/tools` to see Morph's `edit_file` tool\
    **Cursor/VS Code**: Make any code edit request - should use Morph automatically\
    **Codex**: Run `codex mcp list` to verify server is configured, then make edit requests\
    **Manual**: Check server logs show "MCP Server started successfully"
  </Step>
</Steps>

## Configuration

| Variable         | Default   | Description                                                  |
| ---------------- | --------- | ------------------------------------------------------------ |
| `MORPH_API_KEY`  | Required  | Your API key                                                 |
| `ALL_TOOLS`      | `"true"`  | `"false"` for edit-only, `"true"` for full filesystem access |
| `WORKSPACE_MODE` | `"true"`  | Auto workspace detection                                     |
| `DEBUG`          | `"false"` | Debug logging                                                |

## Available Tools

**`edit_file`** - 10,500+ tokens/sec code editing via Morph Apply

**Additional tools** (when `ALL_TOOLS: "true"`):
`read_file`, `write_file`, `list_directory`, `create_directory`, `search_files`, `move_file`, `get_file_info`

## Troubleshooting

**Server won't start**: Check API key, Node.js 16+, run `npm cache clean --force`\
**Tools missing**: Restart client, validate JSON config\
**Workspace issues**: Add `.git` or `package.json`, or set `WORKSPACE_MODE="false"`\
**Slow performance**: Use `edit_file` over `write_file`, check network to api.morphllm.com

## Performance Optimization

### Best Practices

1. **Use `edit_file` for modifications**: Much faster than reading + writing entire files
2. **Minimize edit scope**: Include only the sections that need changes
3. **Batch related edits**: Make multiple changes in a single `edit_file` call
4. **Enable edit-only mode**: Use `ALL_TOOLS: "false"` when you only need editing capabilities

### Performance Comparison

| Method                 | Speed                 | Use Case                    |
| ---------------------- | --------------------- | --------------------------- |
| `edit_file` (Morph)    | 10,500+ tokens/sec    | Code modifications, updates |
| Traditional read/write | \~100-500 tokens/sec  | Full file rewrites          |
| Search & replace       | \~200-1000 tokens/sec | Simple text substitutions   |

